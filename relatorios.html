<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biergarten | Relat√≥rios</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root {
  --amarelo: #F4C430;
  --preto: #1a1a1a;
  --preto80: #262626;
}

body {
  font-family: Arial, sans-serif;
  background: var(--preto);
  color: #fff;
  margin: 0;
  padding: 20px;
}

.topo {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

h1 {
  color: var(--amarelo);
  margin: 0;
}

a.voltar {
  color: #000;
  background: var(--amarelo);
  padding: 8px 12px;
  border-radius: 6px;
  text-decoration: none;
  font-weight: bold;
}

.acoes {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

input, button {
  padding: 10px;
  border-radius: 6px;
  border: none;
  font-weight: bold;
}

button {
  background: var(--amarelo);
  cursor: pointer;
}

.registro {
  background: var(--preto80);
  border-left: 6px solid var(--amarelo);
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 6px;
}

.registro small {
  color: #ccc;
}
  .tabela {
  width: 100%;
  border-collapse: collapse;
  background: var(--preto80);
}

.tabela th, .tabela td {
  border: 1px solid #444;
  padding: 8px;
  text-align: left;
}

.tabela th {
  background: var(--amarelo);
  color: #000;
}

.entrada {
  color: #4caf50;
  font-weight: bold;
}

.saida {
  color: #ff5252;
  font-weight: bold;
}

</style>
</head>

<body>

<div class="topo">
  <h1>üç∫ Biergarten ‚Äî Relat√≥rios</h1>
  <a href="index.html" class="voltar">‚¨Ö Voltar</a>
</div>

<div class="acoes">
  <input type="month" id="mes">
  <button id="btnPdf">üìÑ Exportar PDF</button>
</div>

<div id="lista"></div>

<!-- üî• FIREBASE + RELAT√ìRIO -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  getDocs,
  query,
  orderBy
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* üî• FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyB4fG9rCJq2nUAWgu_wpCxCy8zLUvziBIA",
  authDomain: "biergarten-f5756.firebaseapp.com",
  projectId: "biergarten-f5756",
  storageBucket: "biergarten-f5756.firebasestorage.app",
  messagingSenderId: "391344176716",
  appId: "1:391344176716:web:db69d2b7d99fca2a377ee9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ELEMENTOS */
const lista = document.getElementById("lista");
const mesInput = document.getElementById("mes");

/* BUSCAR DADOS */
async function carregarDados() {
  lista.innerHTML = "Carregando...";

  const q = query(
    collection(db, "movimentacoes"),
    orderBy("data", "asc")
  );

  const snapshot = await getDocs(q);

  const linhas = [];

  snapshot.forEach(doc => {
    const mov = doc.data();
    const data = mov.data.toDate().toLocaleDateString();

    mov.itens.forEach(item => {
      linhas.push({
  data,
  colaborador: mov.colaborador || "-",
  produto: item.produto,
  entrada: mov.tipo === "entrada" ? item.quantidade : "",
  saida: mov.tipo === "saida" ? item.quantidade : ""
      });
    });
  });

  render(linhas);
}

/* RENDER PLANILHA */
function render(linhas) {
  lista.innerHTML = `
    <table class="tabela">
      <thead>
        <tr>
          <th>Data</th>
          <th>Colaborador</th>
          <th>Produto</th>
          <th>Entrada</th>
          <th>Sa√≠da</th>
        </tr>
      </thead>
      <tbody>
        ${linhas.map(l => `
          <tr>
            <td>${l.data}</td>
            <td>${l.colaborador}</td>
            <td>${l.produto}</td>
            <td class="entrada">${l.entrada}</td>
            <td class="saida">${l.saida}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>
  `;
}

carregarDados();
</script>


</body>
</html>


