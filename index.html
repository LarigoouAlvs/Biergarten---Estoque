<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Biergarten | Controle de Estoque</title>

<style>
:root {
  --amarelo: #F4C430;
  --preto: #1a1a1a;
  --preto80: #262626;
}

* { box-sizing: border-box; }

body {
  font-family: Arial, sans-serif;
  background: var(--preto);
  color: #fff;
  margin: 0;
  padding: 20px;
}

/* ... mantenha suas vari√°veis :root ... */

header {
  display: flex;
  flex-direction: column; /* No tablet/mobile empilha o t√≠tulo e o menu */
  gap: 15px;
  margin-bottom: 25px;
}

.topo-desktop {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

/* CONTAINER DO MENU */
.acoes-topo {
  display: grid;
  /* Criar colunas autom√°ticas que se ajustam ao tamanho da tela */
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 8px;
  width: 100%;
}

.acoes-topo a {
  background: var(--preto80);
  color: #fff;
  padding: 12px 8px;
  border-radius: 8px;
  text-decoration: none;
  font-weight: bold;
  font-size: 13px;
  text-align: center;
  border: 1px solid var(--borda);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: 0.2s;
}

.acoes-topo a:hover {
  background: var(--amarelo);
  color: #000;
}

/* AJUSTE PARA CELULAR (Telas bem pequenas) */
@media (max-width: 600px) {
  .menu-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--amarelo);
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 8px;
    font-size: 22px;
    cursor: pointer;
  }

  .acoes-topo {
    display: none; /* Esconde no celular para usar o toggle */
    grid-template-columns: 1fr 1fr; /* Duas colunas no celular quando aberto */
    position: absolute;
    top: 80px;
    left: 20px;
    right: 20px;
    width: calc(100% - 40px);
    background: var(--preto);
    z-index: 1000;
    padding: 10px;
    border: 1px solid var(--amarelo);
  }

  .acoes-topo.active {
    display: grid;
  }
}

/* AJUSTE PARA TABLET (Telas m√©dias) */
@media (min-width: 601px) and (max-width: 1024px) {
  .menu-toggle { display: none; }
  .acoes-topo {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 bot√µes por linha no tablet */
  }
}

/* DESKTOP */
@media (min-width: 1025px) {
  header { flex-direction: row; }
  .menu-toggle { display: none; }
  .acoes-topo {
    grid-template-columns: repeat(8, 1fr); /* Todos em uma linha no PC */
  }
}

/* BOT√ÉO ‚ò∞ */
.menu-toggle {
  display: none;
  background: var(--amarelo);
  color: #000;
  border: none;
  width: 44px;      /* üëà largura fixa */
  height: 44px;     /* üëà altura fixa */
  border-radius: 8px;
  font-size: 22px;
  cursor: pointer;
}

/* MOBILE ATUALIZADO */
@media (max-width: 768px) {
  .menu-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .acoes-topo {
    display: none;
    position: absolute;
    top: 60px;
    right: 0;
    width: 200px; /* Aumentei um pouco a largura */
    max-height: 80vh; /* Limita a altura a 80% da tela */
    overflow-y: auto; /* Adiciona scroll se houver muitos itens */
    background: var(--preto80);
    border-radius: 10px;
    padding: 10px;
    flex-direction: column;
    gap: 4px; /* Diminu√≠ o espa√ßo entre bot√µes para caber mais */
    z-index: 999;
    border: 1px solid var(--borda);
  }

  .acoes-topo a {
    padding: 12px 10px; /* Bot√µes mais altos para facilitar o clique no celular */
    font-size: 14px;
    text-align: left;
    border-bottom: 1px solid #333; /* Linha divis√≥ria sutil */
  }

  .acoes-topo a:last-child {
    border-bottom: none;
  }

  .acoes-topo.active {
    display: flex;
  }
}

 
</style>
</head>

<script>
  function toggleMenu() {
    document.getElementById("menu").classList.toggle("active");
  }
</script>

<body>

<header>
  <h1>üç∫ Biergarten</h1>

  <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>

  <div class="acoes-topo" id="menu">
    <a href="recado.html">üìù Mural</a>
    <a href="contagemsoft.html">ü•§ Softs</a>
    <a href="contagemdestilados.html">üç∏ Destilados</a>
    <a href="contagemvinhos.html">üç∑ Vinhos</a>
    <a href="escala.html">üìÖ Escala</a>
    <a href="relatorios.html">üìä Relat√≥rios</a>
    <a href="hortifruti.html">ü•¨ Hortifr√∫ti</a>
    <a href="drinks.html">üçπ Receitas</a>
  </div>
</header>


<input type="text" id="busca" placeholder="üîç Buscar produto...">
<div id="lista"></div>

<div id="resumo" class="hidden">
  <h3>Resumo da Movimenta√ß√£o</h3>
  <ul id="itens"></ul>

  <select id="tipo">
    <option value="">Tipo de movimenta√ß√£o</option>
    <option value="entrada">Entrada</option>
    <option value="saida">Sa√≠da</option>
  </select>

  <select id="colaborador">
    <option value="">Colaborador</option>
    <option>Daniel</option>
    <option>Larissa</option>
    <option>Samuel</option>
    <option>Alisson</option>
  </select>

  <button id="finalizar" disabled>Finalizar Movimenta√ß√£o</button>
</div>

<!-- üî• FIREBASE + L√ìGICA -->
<script type="module">
/* üî• FIREBASE */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB4fG9rCJq2nUAWgu_wpCxCy8zLUvziBIA",
  authDomain: "biergarten-f5756.firebaseapp.com",
  projectId: "biergarten-f5756",
  storageBucket: "biergarten-f5756.firebasestorage.app",
  messagingSenderId: "391344176716",
  appId: "1:391344176716:web:db69d2b7d99fca2a377ee9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* üì¶ PRODUTOS */
const produtos = [
 "√Ågua com G√°s",
"√Ågua sem G√°s",
"Coca-Cola",
"Coca-Cola Zero",
"Guaran√°",
"Guaran√° Zero",
"H2O Lim√£o",
"H2O Limoneto",
"Red Bull Tradicional",
"Red Bull Tropical",
"Red Bull Zero",
"Schweppes Citrus",
"Sprite",
"Fanta Laranja",
"T√¥nica Schweppes",
"T√¥nica Zero Schweppes",
"√Ågua Perrier",
"Acqua Panna",
"S. Pellegrino",
"Cerveja Long Neck",
"Heineken Zero",
"Stella Artois Gold",
"Stella Artois",
];

/* üß† ESTADO */
let selecionados = JSON.parse(localStorage.getItem("temporario")) || [];

/* üîó ELEMENTOS */
const lista = document.getElementById("lista");
const busca = document.getElementById("busca");
const resumo = document.getElementById("resumo");
const itens = document.getElementById("itens");
const tipo = document.getElementById("tipo");
const colaborador = document.getElementById("colaborador");
const finalizar = document.getElementById("finalizar");

/* üñ•Ô∏è RENDER */
function render(filtro = "") {
  lista.innerHTML = "";

  produtos
    .filter(p => p.toLowerCase().includes(filtro.toLowerCase()))
    .forEach(produto => {
      const qtd = selecionados.find(i => i.produto === produto)?.quantidade || 0;

      const div = document.createElement("div");
      div.className = "produto";
      div.innerHTML = `
  <span>${produto}</span>
  <div class="botoes">
    <button onclick="sub('${produto}')">-1</button>
    <button onclick="add('${produto}',1)">+1</button>
    <button onclick="add('${produto}',6)">+6</button>
    <button onclick="add('${produto}',12)">+12</button>
    <strong>${qtd}</strong>
  </div>
`;

      lista.appendChild(div);
    });
}

/* ‚ûï ADD */
window.add = function(produto, qtd) {
  const item = selecionados.find(i => i.produto === produto);
  if (item) item.quantidade += qtd;
  else selecionados.push({ produto, quantidade: qtd });

  salvarTemp();
  atualizarResumo();
  render(busca.value);
};

/* ‚ûñ SUB -1 */
window.sub = function(produto) {
  const item = selecionados.find(i => i.produto === produto);
  if (!item) return;

  item.quantidade -= 1;

  if (item.quantidade <= 0) {
    selecionados = selecionados.filter(i => i.produto !== produto);
  }

  salvarTemp();
  atualizarResumo();
  render(busca.value);
};


/* üóëÔ∏è REMOVER */
window.remover = function(produto) {
  selecionados = selecionados.filter(i => i.produto !== produto);
  salvarTemp();
  atualizarResumo();
  render(busca.value);
};

/* üìã RESUMO */
function atualizarResumo() {
  itens.innerHTML = "";
  resumo.classList.toggle("hidden", selecionados.length === 0);

  selecionados.forEach(i => {
    const li = document.createElement("li");
    li.innerHTML = `
  <span class="texto-item">${i.quantidade}x ${i.produto}</span>
  <button class="lixeira" onclick="remover('${i.produto}')" title="Remover">üóëÔ∏è</button>
`;

    itens.appendChild(li);
  });

  validar();
}

function validar() {
  finalizar.disabled = !(tipo.value && colaborador.value && selecionados.length);
}

function salvarTemp() {
  localStorage.setItem("temporario", JSON.stringify(selecionados));
}

/* üöÄ SALVAR NO FIREBASE */
finalizar.onclick = async () => {
  await addDoc(collection(db, "movimentacoes"), {
    tipo: tipo.value,
    colaborador: colaborador.value,
    data: new Date(),
    itens: selecionados
  });

  localStorage.removeItem("temporario");
  alert("Movimenta√ß√£o salva no Firebase üî•");

  selecionados = [];
  tipo.value = "";
  colaborador.value = "";
  resumo.classList.add("hidden");
  render();
};

/* üîç EVENTOS */
busca.oninput = e => render(e.target.value);
tipo.onchange = validar;
colaborador.onchange = validar;

render();
atualizarResumo();
</script>

</body>
</html>
