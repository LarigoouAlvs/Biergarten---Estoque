<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Biergarten | Contagem</title>

<style>
:root{
  --amarelo:#F4C430;
  --preto:#1a1a1a;
  --preto80:#262626;
  --borda:#444;
}

body{
  background:var(--preto);
  color:#fff;
  font-family:Arial, sans-serif;
  padding:20px;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

header h1{ color:var(--amarelo); margin:0; }

header a{
  background:var(--amarelo);
  color:#000;
  padding:8px 12px;
  border-radius:6px;
  text-decoration:none;
  font-weight:bold;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}

th, td{
  border:1px solid var(--borda);
  padding:6px;
  text-align:center;
}

th{
  background:var(--amarelo);
  color:#000;
}

td.nome{
  text-align:left;
  font-weight:bold;
}

button{
  background:var(--amarelo);
  border:none;
  padding:4px 8px;
  border-radius:4px;
  cursor:pointer;
  font-weight:bold;
}

.acoes{
  display:flex;
  gap:4px;
  justify-content:center;
}

footer{
  margin-top:20px;
}

footer button{
  width:100%;
  padding:12px;
  font-size:16px;
}
</style>
</head>

<body>

<header>
  <h1>ðŸ“¦ Contagem de Vinhos & Espumantes</h1>
  <a href="index.html">â¬… Voltar</a>
</header>

<table id="tabela">
  <thead>
    <tr>
      <th>Item</th>
      <th>MÃ­nimo</th>
      <th>Estoque</th>
      <th>Bar</th>
      <th>Pedido</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<footer>
  <button id="salvar">ðŸ’¾ Salvar Contagem</button>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  doc,
  setDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB4fG9rCJq2nUAWgu_wpCxCy8zLUvziBIA",
  authDomain: "biergarten-f5756.firebaseapp.com",
  projectId: "biergarten-f5756",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const tipoContagem = "vinhos";


/* ðŸ”¢ ITENS (EXEMPLO) */
const itens = [

// ESPUMANTES E VINHOS
{ nome:"Salton Series Brut", minimo:6 },
{ nome:"Dom Moscatel", minimo:4 },
{ nome:"Dom Brut", minimo:3 },
{ nome:"Nero Celebration Brut", minimo:3 },
{ nome:"Casa Valduga RosÃ©", minimo:2 },
{ nome:"Cave Amadeu Brut", minimo:6 },
{ nome:"Cave Geisse Brut", minimo:6 },
{ nome:"Ferrari Maximum Brut", minimo:2 },
{ nome:"Veuve Ambal Brut", minimo:4 },

// Champagnes
{ nome:"MoÃ«t & Chandon Brut", minimo:3 },
{ nome:"Veuve Clicquot", minimo:3 },

{ nome:"Casa Valduga Gran Chardonnay",  minimo:4 },
{ nome:"Minhadega Vinho Verde",  minimo:3 },
{ nome:"Casalinho Alvarinho",  minimo:3 },
{ nome:"Monte Estrela",  minimo:2 },
{ nome:"Casa Valduga Terroir",  minimo:6 },
{ nome:"Brisa Sauvignon Blanc",  minimo:6 },
{ nome:"Anubis Susana Balbo Chardonnay",  minimo:3 },
{ nome:"Cartuxa Ã‰vora Branco",  minimo:4 },
{ nome:"Lidio Carrara Faces Chardonnay",  minimo:2 },
{ nome:"Regia Colheita Reserva Branco",  minimo:2 },


{ nome:"Miraval Cotes de Provence",  minimo:3 },
{ nome:"TrÃªs Maria Vinho Verde RosÃ©",  minimo:3 },
{ nome:"Luiz Argenta Jovem RosÃ©",  minimo:2 },


{ nome:"Casa Valduga Pinot Noir",  minimo:3 },
{ nome:"Manz Platonico",  minimo:2 },
{ nome:"Punti Ferrer Carmenere",  minimo:3 },
{ nome:"Punti Ferrer Cabernet Sauvignon",  minimo:0 },
{ nome:"Camporsino Chianti",  minimo:3 },
{ nome:"La Linda Malbec",  minimo:3 },
{ nome:"MÃ³i Primitivo Puglia",  minimo:3 },
{ nome:"Naturelle Tinto",  minimo:3 },
{ nome:"Muros de Vinhas",  minimo:2 },
{ nome:"Origen Cabernet Sauvignon",  minimo:2 },
{ nome:"Origen Merlot",  minimo:2 },
{ nome:"Piatelli Reserva Malbec",  minimo:3 },
{ nome:"Montes Alpha CarmÃ©nÃ¨re",  minimo:2 },
{ nome:"Caladessa Syrah Reserva",  minimo:2 },


{ nome:"Luigi Bosca Malbec",  minimo:2 },
{ nome:"Brunello Caprili",  minimo:2 },
{ nome:"Cartuxa Ã‰vora Tinto",  minimo:2 },
{ nome:"Barolo Del Comune di Serralunga D'Alba",  minimo:2 },
{ nome:"Dom Melchor",  minimo:1 },
{ nome:"Casa Silva Pinot Noir",  minimo:3 },
{ nome:"Dos Fincas",  minimo:3 },
{ nome:"Pizzato Merlot",  minimo:2 },
{ nome:"Chateau La Tour Carnet Haut-MÃ©doc",  minimo:2 },
{ nome:"Chateau Castegens",  minimo:2 },


{ nome:"Vinho do Porto / Porto Cais", dosesPorGarrafa:15, minimo:1 },


{ nome:"Vinho Tinto Entre Portas",  minimo:2 },
{ nome:"Vinho Branco Entre Portas",  minimo:1 },


];

const estado = {};

const tbody = document.querySelector("tbody");

function render(){
  tbody.innerHTML = "";

  itens.forEach(item=>{
    estado[item.nome] ??= { estoque:0, bar:0 };

    const total = estado[item.nome].estoque + estado[item.nome].bar;
    const pedido = Math.max(item.minimo - total, 0);

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="nome">${item.nome}</td>
      <td>${item.minimo}</td>

      <td>
        <div class="acoes">
          <button onclick="alt('${item.nome}','estoque',-1)">-</button>
          ${estado[item.nome].estoque}
          <button onclick="alt('${item.nome}','estoque',1)">+</button>
        </div>
      </td>

      <td>
        <div class="acoes">
          <button onclick="alt('${item.nome}','bar',-1)">-</button>
          ${estado[item.nome].bar}
          <button onclick="alt('${item.nome}','bar',1)">+</button>
        </div>
      </td>

      <td>${pedido}</td>
    `;
    tbody.appendChild(tr);
  });
}

window.alt = (nome, tipo, valor)=>{
  estado[nome][tipo] = Math.max(0, estado[nome][tipo] + valor);
  render();
};

render();

/* ðŸ’¾ SALVAR */
document.getElementById("salvar").onclick = async () => {
  const agora = new Date();

  // ID Ãºnico (data + hora)
  const id = Date.now().toString();

  await setDoc(
    doc(collection(db, "contagens"), id),
    {
       data: agora,
    tipo: tipoContagem,
    itens: estado
    }
  );

  alert("Contagem salva ðŸ”¥");
};


</script>

</body>
</html>
